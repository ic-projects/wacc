-- Test: binarySortTree.wacc

-- Uploaded file: 
---------------------------------------------------------------
# The program reads n (number of integers), then n integers. After each input, 
# it insert the integer into a binary search tree. At the end, it prints out 
# the content in the binary search tree so that we have a sorted list of 
# integer.
# 
# We represent a node in the binary search tree using two pair elements. The 
# first element has a type <int, pair>, the int is the integer stored in the 
# node, the pair is the pointer to the second pair element. The second pair 
# element has a type <pair, pair> which is the pointer to the two children 
# nodes in the binary search tree.

begin

  # Create a new node of a binary search tree having the given integer value 
  # and points to the two given pairs.
  pair(int, pair) createNewNode(int value, pair(int, pair) left, pair(int, pair) right) is
    pair(pair, pair) p = newpair(left, right) ;
    pair(int, pair) q = newpair(value, p) ;
    return q
  end

  # Given a root of a binary search tree and an integer to insert, the function 
  # inserts the integer into the tree and returns the new root of the tree.
  pair(int, pair) insert(pair(int, pair) root, int n) is
    if root == null then
      root = call createNewNode(n, null, null)
    else
      pair(pair, pair) p = snd root ;
      int current = fst root ;
      pair(int, pair) q = null ;
      if n < current then
      	q = fst p ;
        fst p = call insert(q, n)
      else 
      	q = snd p ;
        snd p = call insert(q, n)
      fi 
    fi ;
    return root
  end

  # Print the integers in the binary search tree in the increasing order.
  int printTree(pair(int, pair) root) is
    if root == null then
      return 0 
    else
      pair(pair, pair) body = snd root ;
      pair(int, pair) p = fst body ;
      int temp = call printTree(p) ;
      temp = fst root ; 
      print temp ;
      print ' ' ;
      p = snd body ;
      temp = call printTree(p) ;
      return 0
    fi
  end

  # The main function
  int n = 0 ;
  print "Please enter the number of integers to insert: " ;
  read n ;
  print "There are " ;
  print n ;
  println " integers." ;
  int i = 0 ;
  pair(int, pair) root = null ;
  while i < n do
    int x = 0 ;
    print "Please enter the number at position " ; 
    print i + 1 ;
    print " : " ;
    read x ;
    root = call insert(root, x) ;
    i = i + 1
  done ;
  print "Here are the numbers sorted: " ;
  i = call printTree(root) ;
  println ""
end



---------------------------------------------------------------

-- Compiler Output:
-- Compiling...
-- Printing AST...
binarySortTree.ast contents are:
===========================================================
0	Program
1	  - int createNewNode(int value, int left, int right)
2	    - DECLARE
3	      - TYPE
4	        - 
5	      - LHS
6	        - p
7	      - RHS
8	        - NEW_PAIR
9	          - FST
10	            - left
11	          - SND
12	            - right
13	    - DECLARE
14	      - TYPE
15	        - int
16	      - LHS
17	        - q
18	      - RHS
19	        - NEW_PAIR
20	          - FST
21	            - value
22	          - SND
23	            - p
24	    - RETURN
25	      - q
26	  - int insert(int root, int n)
27	    - IF
28	      - CONDITION
29	        - ==
30	          - root
31	          - null
32	      - THEN
33	        - ASSIGNMENT
34	          - LHS
35	            - root
36	          - RHS
37	            - createNewNode
38	            - n
39	            - null
40	            - null
41	      - ELSE
42	        - DECLARE
43	          - TYPE
44	            - 
45	          - LHS
46	            - p
47	          - RHS
48	            - SND
49	              - root
50	        - DECLARE
51	          - TYPE
52	            - int
53	          - LHS
54	            - current
55	          - RHS
56	            - FST
57	              - root
58	        - DECLARE
59	          - TYPE
60	            - int
61	          - LHS
62	            - q
63	          - RHS
64	            - null
65	        - IF
66	          - CONDITION
67	            - <
68	              - n
69	              - current
70	          - THEN
71	            - ASSIGNMENT
72	              - LHS
73	                - q
74	              - RHS
75	                - FST
76	                  - p
77	            - ASSIGNMENT
78	              - LHS
79	                - FST
80	                  - p
81	              - RHS
82	                - insert
83	                - q
84	                - n
85	          - ELSE
86	            - ASSIGNMENT
87	              - LHS
88	                - q
89	              - RHS
90	                - SND
91	                  - p
92	            - ASSIGNMENT
93	              - LHS
94	                - SND
95	                  - p
96	              - RHS
97	                - insert
98	                - q
99	                - n
100	    - RETURN
101	      - root
102	  - int printTree(int root)
103	    - IF
104	      - CONDITION
105	        - ==
106	          - root
107	          - null
108	      - THEN
109	        - RETURN
110	          - 0
111	      - ELSE
112	        - DECLARE
113	          - TYPE
114	            - 
115	          - LHS
116	            - body
117	          - RHS
118	            - SND
119	              - root
120	        - DECLARE
121	          - TYPE
122	            - int
123	          - LHS
124	            - p
125	          - RHS
126	            - FST
127	              - body
128	        - DECLARE
129	          - TYPE
130	            - int
131	          - LHS
132	            - temp
133	          - RHS
134	            - printTree
135	            - p
136	        - ASSIGNMENT
137	          - LHS
138	            - temp
139	          - RHS
140	            - FST
141	              - root
142	        - PRINT
143	          - temp
144	        - PRINT
145	          - ' '
146	        - ASSIGNMENT
147	          - LHS
148	            - p
149	          - RHS
150	            - SND
151	              - body
152	        - ASSIGNMENT
153	          - LHS
154	            - temp
155	          - RHS
156	            - printTree
157	            - p
158	        - RETURN
159	          - 0
160	  - int main()
161	    - DECLARE
162	      - TYPE
163	        - int
164	      - LHS
165	        - n
166	      - RHS
167	        - 0
168	    - PRINT
169	      - "Please enter the number of integers to insert: "
170	    - READ
171	      - n
172	    - PRINT
173	      - "There are "
174	    - PRINT
175	      - n
176	    - PRINTLN
177	      - " integers."
178	    - DECLARE
179	      - TYPE
180	        - int
181	      - LHS
182	        - i
183	      - RHS
184	        - 0
185	    - DECLARE
186	      - TYPE
187	        - int
188	      - LHS
189	        - root
190	      - RHS
191	        - null
192	    - LOOP
193	      - CONDITION
194	        - <
195	          - i
196	          - n
197	      - DO
198	        - DECLARE
199	          - TYPE
200	            - int
201	          - LHS
202	            - x
203	          - RHS
204	            - 0
205	        - PRINT
206	          - "Please enter the number at position "
207	        - PRINT
208	          - +
209	            - i
210	            - 1
211	        - PRINT
212	          - " : "
213	        - READ
214	          - x
215	        - ASSIGNMENT
216	          - LHS
217	            - root
218	          - RHS
219	            - insert
220	            - root
221	            - x
222	        - ASSIGNMENT
223	          - LHS
224	            - i
225	          - RHS
226	            - +
227	              - i
228	              - 1
229	    - PRINT
230	      - "Here are the numbers sorted: "
231	    - ASSIGNMENT
232	      - LHS
233	        - i
234	      - RHS
235	        - printTree
236	        - root
237	    - PRINTLN
238	      - ""
===========================================================
-- Finished

